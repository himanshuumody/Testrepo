    public without sharing class EI_PrescribedInformationNew {
        
        
      //  public list<property__c> propList{get;set;}
        public list<Deposit__c> depositList{get;set;}
      //  public  User currentUserHC {get;set;}
        public List<string> originalList{get;set;}
        public List<String> firstHalf {get;set;}
        public List<String> secondHalf {get;set;}
        public List<Property_Allocation__c> jointll {get;set;}
        public  User currentUser {get;set;}
        public  string agentName {get;set;}
        public  String currentUserPIClause {get;set;}
        public string currentUserPIReferClause{get;set;}
        public  String currentUserPIRef {get;set;}
        public  String landlordList {get;set;}
        public  String landlordRegNo{get;set;}
        public  boolean rendersadieedata {get;set;}
        public  boolean renderotherdata {get;set;}
        public  String ContactedTo {get;set;}
        public  Boolean isAgent    {get;set;}
        public  Boolean isJointLL  {get;set;}
        public EI_PrescribedInformationNew (){
            Id recid = ApexPages.currentPage().getParameters().get('id');
            String scotlandAddress = System.Label.SDSAddress;
            isAgent = false;
            IsJointLL = false;
            ContactedTo = 'SafeDeposits Scotland can be contacted through their website,<a href="https://www.safedepositsscotland.com/"> Home - SafeDeposits Scotland</a>, in writing to<br/> SafeDeposits Scotland, '+scotlandAddress ;
            currentUser = [select id, Name, Contact.Prescribed_clause_reference__c, Contact.Prescribed_Information_Clauses__c, profile.name,contact.Account.IsPersonAccount from user where id=:UserInfo.getUserId() ];
            if(currentUser.profile.name == 'Agent'){
             agentName = currentUser.Name;  
             isAgent = true;
            }
            System.debug('::UserInfo='+currentUser);
            //currentUserPIClause = currentUser.Contact.Prescribed_Information_Clauses__c; 
            system.debug('line-->19' + currentUserPIClause );
            // currentUserPIReferClause = currentUser.Contact.Prescribed_clause_reference__c;
            // currentUserHC = [select id, Name, Contact.Prescribed_clause_reference__c, Contact.Prescribed_Information_Clauses__c, profile.name from user where id='0058E0000091YiE' ];
            String propertyId = [SELECT Property__c FROM Deposit__c where Id =: recid limit 1].Property__c;
            System.debug('::propertyId => '+propertyId);
            
            // propList=[Select Id,Name,Postal_Code__c,Property_Owner__c,Property_Owner__r.Address__pc,Property_Owner__r.Name,City__c,House_No__c,Landlord_Registration_Number__c,Property_Owner__r.recordtype.name,
            //         (select id,Amount_of_Deposit_Protected_by_TDS__c,Tenants_Name__c,Date_Received_by_Scheme__c,Property_Address__c,Property__c,Date_Deposit_Received__c,Customer__r.Prescribed_clause_reference__pc,
            //         Property__r.House_No__c,Property__r.City__c,Payment_Received_By_Scheme__c,
            //         Property__r.Street__c,Protected_Amount__c,Property__r.Country__c,Property__r.State__c,Customer__r.Prescribed_Information_Clauses__pc from Deposits__r where id=: recid limit 1 ),
            //         (select id,Property__c,Landlord_Registration_Number__c,Contact__c,Contact__r.Name from Property_Allocations__r limit 200)
            //         from Property__c WHERE Id =: propertyId limit 1];
            
            //     currentUserPIClause = currentUser.Contact.Prescribed_Information_Clauses__c;
            //     currentUserPIReferClause = currentUser.Contact.Prescribed_clause_reference__c;
            
            // Integer propAllList = propList[0].Property_Allocations__r.size();
            // landlordList = '';
            // for(integer i=0;i<propAllList;i++){
            //      landlordList = landlordList + propList[0].Property_Allocations__r[i].Contact__r.Name;
            
            //     if(propAllList > 1 && propList[0].Property_Allocations__r[propAllList-1].Id != propList[0].Property_Allocations__r[i].Id){
            //        landlordList = landlordList+', '; 
            //     }else{
            //         landlordList = landlordList+''; 
            //     }
            // }
            currentUserPIReferClause ='';
            depositList = [select id,Actual_Protected_Amount__c,PI_Clause__c,EI_PI_Clause_wording__c,Amount_of_Deposit_Protected_by_TDS__c, Tenants_Name__c, Date_Received_by_Scheme__c, Property_Address__c,
                           Protected_Amount__c, Date_Deposit_Received__c, Customer__r.Prescribed_clause_reference__pc, Property__r.House_No__c, 
                           Payment_Received_By_Scheme__c,Property__r.Street__c,Property__r.Country__c,Property__r.State__c,Property__r.County__c,
                           Customer__r.Prescribed_Information_Clauses__pc,property__r.Landlord_Registration_Number__c,Date_Agent_Landlord_Received_Deposit__c,
                           Property__c, Property__r.Name, Property__r.Postal_Code__c, Property__r.Property_Owner__c, Property__r.Property_Owner__r.Address__pc, 
                           Property__r.Property_Owner__r.Name, Property__r.City__c, Property__r.Local_authority_registration_details__c, Property__r.Property_Owner__r.recordtype.name,createdby.name,Customer__r.EI_PIClause__c,Customer__r.EI_PIInfomation__c
                           from deposit__c where id=: recid ORDER BY Customer__c];
            if(depositList[0].customer__r.EI_PIClause__c != NULL){
                currentUserPIReferClause= depositList[0].customer__r.EI_PIClause__c;
            }
            if(depositList[0].PI_Clause__c != NULL){
                currentUserPIReferClause = currentUserPIReferClause+'<br/>'+depositList[0].PI_Clause__c;
            }
            if(depositList[0].customer__r.EI_PIInfomation__c != NULL){
                currentUserPIClause = depositList[0].customer__r.EI_PIInfomation__c;
            }
            if(depositList[0].EI_PI_Clause_wording__c != NULL){
                currentUserPIClause = currentUserPIClause+'<br/>'+depositList[0].EI_PI_Clause_wording__c;
            }
            if(depositList[0].Tenants_Name__c !=null){
                originalList = depositList[0].Tenants_Name__c.split(',');
                Integer size = originalList.size();
                Integer splitPoint = (size + 1) / 2; // This handles both even and odd cases
                
                 firstHalf = new List<String>();
                 secondHalf = new List<String>();
                
                for (Integer i = 0; i < size; i++) {
                    if (i < splitPoint) {
                        firstHalf.add(originalList[i]);
                    } else {
                        secondHalf.add(originalList[i]);
                    }
                }
            }
            
            List<Property_Allocation__c> propAllocList = [select id,Relation_to_Property__c,Property__r.Landlord_Registration_Number__c,Contact__r.Landlord_Registration_Number__c,Property__c,Landlord_Registration_Number__c,Contact__c,Contact__r.Name,Contact__r.Account.IsPersonAccount ,Contact__r.Account.Name from Property_Allocation__c where property__c=: propertyId];
            landlordList = '';
            for(integer i=0;i<propAllocList.size();i++){
                if(propAllocList[i].Relation_to_Property__c == 'Primary Landlord'){
                    String llNo = propAllocList[i].Contact__r.Landlord_Registration_Number__c;
                    system.debug('@@ '+propAllocList[i].Landlord_Registration_Number__c);
                    system.debug('@@11 '+propAllocList[i].Property__r.Landlord_Registration_Number__c);
                    if(propAllocList[i].Contact__r.Landlord_Registration_Number__c!=null) 
                    {   
                       //commented for  TGK-330 start
                        /* if(!llNo.contains('null') ){
                             landlordRegNo = propAllocList[i].Contact__r.Landlord_Registration_Number__c; 
                         }
                         else */
                        //commented for  TGK-330 End
                         if(propAllocList[i].Landlord_Registration_Number__c != null) 
                         {landlordRegNo = propAllocList[i].Landlord_Registration_Number__c;}
                         else
                         {    landlordRegNo = propAllocList[i].Property__r.Landlord_Registration_Number__c;}
                     
                    }
                    else if(propAllocList[i].Landlord_Registration_Number__c != null) 
                    {landlordRegNo = propAllocList[i].Landlord_Registration_Number__c;}
                    else
                    {    landlordRegNo = propAllocList[i].Property__r.Landlord_Registration_Number__c;}
                    
                    if(propAllocList[i].Contact__r.Account.IsPersonAccount){
                        landlordList = landlordList + propAllocList[i].Contact__r.Name;
                    }else{
                        landlordList = landlordList + propAllocList[i].Contact__r.Account.Name;
                    }
                    
                    break;
                }
            }
            jointll = new list<Property_Allocation__c> ();
            for(Property_Allocation__c pc :propAllocList){
                if(pc.Relation_to_Property__c !='Primary Landlord'){
                  jointll.add(pc);
                }
            }
            if(jointll.size()>0){
            isJointLL = true;
            }
            //System.debug('List='+propList.size());
            //System.debug('Data='+propList[0]);
            // String str = 'attachment; filename='+depositList[0].Property__r.Name+'.pdf';
            
            // Apexpages.currentPage().getHeaders().put('content-disposition',str);
            
        }
        
    }
